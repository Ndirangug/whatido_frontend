import { useRouter } from 'next/router';
import { useEffect, useState } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { setAuthComonent } from '../../../store/reducers/app_surface_reducer';
import { StyledIconBtn } from '../../../styles/utils.styles';

function ProfileIcon() {
  const [selectedRoute, setSelectedRoute] = useState(false);
  const router = useRouter();
  let color = selectedRoute ? '#ffffff' : '#808080';

  const authenticated = useSelector((state) => state.auth.authenticated);
  const user = useSelector((state) => state.auth.currentUser);
  const dispatch = useDispatch();

  const goProfile = () => {
    if (!authenticated) {
      dispatch(setAuthComonent('LOGIN'));
    } else {
      router.push(`/profile/${user?.slug}`);
    }
  };

  useEffect(() => {
    router.asPath.includes('/profile')
      ? setSelectedRoute(true)
      : setSelectedRoute(false);
  }, [router.asPath]);

  return (
    <StyledIconBtn selected={selectedRoute} onClick={goProfile}>
      <svg
        width="42"
        height="62"
        viewBox="0 0 42 62"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g opacity="0.5">
          <path
            d="M20.9998 12.6665C18.8165 12.6665 17.0415 14.4415 17.0415 16.6248C17.0415 18.7665 18.7165 20.4998 20.8998 20.5748C20.9665 20.5665 21.0332 20.5665 21.0832 20.5748C21.0998 20.5748 21.1082 20.5748 21.1248 20.5748C21.1332 20.5748 21.1332 20.5748 21.1415 20.5748C23.2748 20.4998 24.9498 18.7665 24.9582 16.6248C24.9582 14.4415 23.1832 12.6665 20.9998 12.6665Z"
            fill={color}
          />
          <path
            d="M25.2333 22.7919C22.9083 21.2419 19.1166 21.2419 16.775 22.7919C15.7166 23.5002 15.1333 24.4586 15.1333 25.4836C15.1333 26.5086 15.7166 27.4586 16.7666 28.1586C17.9333 28.9419 19.4666 29.3336 21 29.3336C22.5333 29.3336 24.0666 28.9419 25.2333 28.1586C26.2833 27.4502 26.8666 26.5002 26.8666 25.4669C26.8583 24.4419 26.2833 23.4919 25.2333 22.7919Z"
            fill={color}
          />
          <path
            d="M11.5358 39C12.1625 39 12.6858 39.21 13.1058 39.63C13.5258 40.05 13.7358 40.5733 13.7358 41.2C13.7358 41.8267 13.5258 42.35 13.1058 42.77C12.6858 43.19 12.1625 43.4 11.5358 43.4H9.73582V46H9.03582V39H11.5358ZM11.5358 42.74C11.9692 42.74 12.3258 42.5967 12.6058 42.31C12.8925 42.0167 13.0358 41.6467 13.0358 41.2C13.0358 40.7533 12.8925 40.3867 12.6058 40.1C12.3258 39.8067 11.9692 39.66 11.5358 39.66H9.73582V42.74H11.5358ZM14.9886 41.83C15.2953 41.2233 15.8219 40.92 16.5686 40.92V41.56C16.1153 41.56 15.7386 41.6933 15.4386 41.96C15.1386 42.2267 14.9886 42.6467 14.9886 43.22V46H14.3286V41H14.9886V41.83ZM20.9524 45.37C20.4457 45.87 19.8257 46.12 19.0924 46.12C18.3591 46.12 17.7357 45.87 17.2224 45.37C16.7157 44.8633 16.4624 44.24 16.4624 43.5C16.4624 42.76 16.7157 42.14 17.2224 41.64C17.7357 41.1333 18.3591 40.88 19.0924 40.88C19.8257 40.88 20.4457 41.1333 20.9524 41.64C21.4657 42.14 21.7224 42.76 21.7224 43.5C21.7224 44.24 21.4657 44.8633 20.9524 45.37ZM17.6924 44.91C18.0724 45.29 18.5391 45.48 19.0924 45.48C19.6457 45.48 20.1124 45.29 20.4924 44.91C20.8724 44.5233 21.0624 44.0533 21.0624 43.5C21.0624 42.9467 20.8724 42.48 20.4924 42.1C20.1124 41.7133 19.6457 41.52 19.0924 41.52C18.5391 41.52 18.0724 41.7133 17.6924 42.1C17.3124 42.48 17.1224 42.9467 17.1224 43.5C17.1224 44.0533 17.3124 44.5233 17.6924 44.91ZM25.9835 41V46H25.3235V41.64H23.2835V46H22.6235V41.64H21.7735V41H22.6235V40.8C22.6235 39.52 23.3235 38.88 24.7235 38.88C25.0035 38.88 25.3235 38.92 25.6835 39V39.6C25.3702 39.5467 25.0502 39.52 24.7235 39.52C24.2235 39.52 23.8569 39.6167 23.6235 39.81C23.3969 40.0033 23.2835 40.3333 23.2835 40.8V41H25.9835ZM26.9718 46V38.7H27.6318V46H26.9718ZM30.9343 40.88C31.6743 40.88 32.271 41.1433 32.7243 41.67C33.1843 42.19 33.4143 42.8067 33.4143 43.52C33.4143 43.5933 33.4077 43.6967 33.3943 43.83H29.0043C29.071 44.3367 29.2843 44.74 29.6443 45.04C30.011 45.3333 30.461 45.48 30.9943 45.48C31.3743 45.48 31.701 45.4033 31.9743 45.25C32.2543 45.09 32.4643 44.8833 32.6043 44.63L33.1843 44.97C32.9643 45.3233 32.6643 45.6033 32.2843 45.81C31.9043 46.0167 31.471 46.12 30.9843 46.12C30.1977 46.12 29.5577 45.8733 29.0643 45.38C28.571 44.8867 28.3243 44.26 28.3243 43.5C28.3243 42.7533 28.5677 42.13 29.0543 41.63C29.541 41.13 30.1677 40.88 30.9343 40.88ZM30.9343 41.52C30.4143 41.52 29.9777 41.6767 29.6243 41.99C29.2777 42.2967 29.071 42.6967 29.0043 43.19H32.7343C32.6677 42.6633 32.4643 42.2533 32.1243 41.96C31.7843 41.6667 31.3877 41.52 30.9343 41.52Z"
            fill={color}
          />
        </g>
      </svg>
    </StyledIconBtn>
  );
}

export default ProfileIcon;
